#!/bin/bash
# Begin

# How to run this script.

# Step 1:        bash pentest-script.sh --email "<email>"         --openapispecurl "<Open APi Spec URL>"
# Example usage: bash pentest-script.sh --email "admin@apisec.ai" --openapispecurl "http://application.apisec.ai:8080/v2/api-docs" 


TEMP=$(getopt -n "$0" -a -l "email:,openapispecurl:" -- --  "$@")
echo $TEMP

    [ $? -eq 0 ] || exit

    eval set --  "$TEMP"

    while [ $# -gt 0 ]
    do
             case "$1" in
                    --email) FX_EMAIL="$2"; shift;;
                    --openapispecurl) FX_OpenAPISpec="$2"; shift;;
                    --) shift;;
             esac
             shift;
    done

echo " "
echo Email-ID: $FX_EMAIL
echo OpenAPISpecUrl: $FX_OpenAPISpec
echo " "

curl --location --request POST 'https://pentest.apisec.ai/api/v1/pentest' --header 'Content-Type: application/json' --data-raw '{     "openAPISpec": "'${FX_OpenAPISpec}'",     "email": "'${FX_EMAIL}'" }'
echo " "
echo " "
echo "Pentest script execution is completed!!!"
